@using WebsiteBanHang.Models
@model List<DonDatHang>

@{
    ViewBag.Title = "DonHangBiHuy";
    Layout = "~/Views/Layout/AdminHomeLayout.cshtml";
    int i = 1;
    List<Shipper> shipper = ViewBag.shipper as List<Shipper>;
}






<h2>Danh Sách Đơn Hàng Bị Hủy</h2>

<table id="example" class="table table-light table-hover table-bordered " style="z-index:99999;">
    <thead>
        <tr>
            <th>STT</th>
            <th>Tên Người Mua</th>
            <th>Địa Chỉ</th>
            <th>Thời Gian Đặt</th>
            <th>Ưu Đãi</th>
            <th>Tình Trạng GH</th>

            <th>Hình Thức Thanh Toán</th>
            <th>Tình Trạng TT</th>
        
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {

            <tr>
                <td>@i</td>
                <td>@item.ThanhVien.HoTen</td>
                <td>@item.DiaChi, @item.Xa.TenXa, @item.Huyen.TenHuyen, @item.Tinh.TenTinh</td>
                <td>@item.NgayDat</td>
                <td>@item.UuDai</td>
                <td>@item.TinhTrangGiaoHang.TenTinhTrang</td>

                <td>@item.HinhThucThanhToan</td>
                @if (@item.DaThanhToan == true)
                {
                    <td>Đã Thanh Toán</td>
                }
                else
                {
                    <td>Chưa Thanh Toán</td>
                }





            </tr>
            i++;
        }


    </tbody>

</table>



<style>
    .itemLSP {
        display: none;
    }
</style>

<script>
    $(document).ready(function () {
        $('#example').DataTable();
    })
    $(".Trang_1").show();
    $('.page-item').click(function () {
        $('.itemLSP').hide();
        var Trang = $(this).attr("data-Trang");

        $('.Trang_' + Trang).show();



    })
    $(".btn-xd").click(function () {
        var maddh = $(this).attr("data-id");
        console.log(maddh);
        $("#select-ship").change(function () {
            var id = $(this).val();
            console.log(id);
            $(".btn-shipper").click(function () {
                $.ajax({
                    type: "GET",
                    url: "http://localhost:62979/Admin/XacNhanDonHang?MaDDH=" + maddh + "&MaShipper=" + id,
                    success: function (data) {
                        console.log(data);
                        if (data.mess = "success") {
                            Swal.fire({

                                icon: 'success',
                                title: 'Xác nhận thành công',
                                text: 'Bạn đã xác nhận đơn hàng thành công',
                                showConfirmButton: true,

                            }).then((result) => {
                                if (result.isConfirmed) {
                                    window.location.reload();
                                }
                            })

                        }
                        else {
                            Swal.fire({

                                icon: 'error',
                                title: 'Xảy ra lỗi',
                                text: 'Đã xảy ra lỗi, vui lòng thử lại sau!',
                                showConfirmButton: true,

                            })
                        }
                    }
                });
            })


        })
    })
</script>