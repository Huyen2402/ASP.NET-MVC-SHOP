@using WebsiteBanHang.Models
@using PagedList.Mvc;
@model PagedList.IPagedList<SanPham>


@{
    ViewBag.Title = "SanPham";
    Layout = "~/Views/Layout/ProductLayout.cshtml";
}

<div class="col-md-9 product1">
    <div class=" row bottom-product">
        @foreach (var item in Model)
        {

            <div class="col-md-4 bottom-cd simpleCart_shelfItem">
                <div class="product-at ">
                    <a href="@Url.Action("XemChiTietSP","SanPham", new  { @id=item.MaSP })">
                        <img class="img-responsive" src="@Url.Content("~/Content/images/"+item.HinhAnh)" alt="">
                        <div class="pro-grid">
                            <span class="buy-in">Mua ngay</span>
                        </div>
                    </a>
                </div>
                <div style="height:50px;">
                    <b><p class="tun">@item.TenSP</p></b>
                </div>
                <a id="ThemGioHang" data-MaSP="@item.MaSP" data-strURL="@Request.Url.ToString()" @*href="@Url.Action("ThemGioHang","GioHang", new { @MaSP = item.MaSP, @strURL = Request.Url.ToString() })"*@ class="item_add ThemGioHang"><p class="number item_price"><i> </i>$@item.DonGia.Value</p></a>
            </div>


            

        }

    </div>

    <div>
        
        @Html.PagedListPager(Model, page => Url.Action("SanPham", new { page = page, @MaLoaiSP = ViewBag.MaLoaiSP, @MaNSX = ViewBag.MaNSX }))
    </div>

    </div>

<script>
    $(".ThemGioHang").click(function () {
        var MaSP = $(this).attr("data-MaSP");
        var strURL = $(this).attr("data-strURL");
        $.ajax({


            type: "get",

            url: "http://localhost:62979/GioHang/ThemGioHang?MaSP=" + MaSP + "&strURL" + strURL,
            contentType: "html",
            statusCode: {
                400: function (xhr) {
                    
                    Swal.fire({

                        icon: 'error',
                        title: 'Sản phẩm đã hết hàng',
                        showConfirmButton: false,
                        timer: 1500

                    })
                }
            },
            success: function (response) {
                debugger
               

                $("#GioHangPartial").html(response);


            }

        })

    


    })
</script>


